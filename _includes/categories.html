<div class="col s12 cat-div">
  <div class="cat-list">
    {% for cat in site.categories %}
    {% assign catvalid = false %}
    {% for post in cat[1] %}
    {% unless post.hidden %}
    {% assign catvalid = true %}
    {% break %}
    {% endunless %}
    {% endfor %}
    {% if catvalid %}
    {% capture test %}{{cat[0] | slice: 0}}{% endcapture %}
    {% capture testup %}{{cat[0] | slice: 0 | upcase}}{% endcapture %}
    <a class="cat-chip" href="#{{cat[0] | slugify}}{% if test == testup %}_cap{% endif %}"><div class="chip z-depth-1">{{cat[0]}}</div></a>
    {% endif %}
    {% endfor %}
  </div>
  <div class="divider"></div>
  <div class="cat-index">
    <script>
      function wpd(post_date) {
        var pdate = new Date(post_date);
        var y = pdate.getFullYear();
        var m = pdate.getMonth() + 1;
        m = m < 10 ? '0' + m : m;
        var d = pdate.getDate();
        d = d < 10 ? ('0' + d) : d;
        document.write(m + '-' + d + ' ' + y);
      }
    </script>
    {% for cat in site.categories %}
    {% assign catvalid = false %}
    {% for post in cat[1] %}
    {% unless post.hidden %}
    {% assign catvalid = true %}
    {% break %}
    {% endunless %}
    {% endfor %}
    {% if catvalid %}
    {% capture test %}{{cat[0] | slice: 0}}{% endcapture %}
    {% capture testup %}{{cat[0] | slice: 0 | upcase}}{% endcapture %}
    <h4 id="{{cat[0] | slugify}}{% if test == testup %}_cap{% endif %}">{{cat[0]}}</h4>
    <ul class="cat-post">
      {% for post in cat[1] %}
      {% unless post.hidden %}
      <a class="post-title" href="{{site.baseurl}}{{post.url}}">
        <li>
          {{post.title}}
          <small class="post-date">
            <noscript>{{post.date | date_to_string}}</noscript>
            <script>
              wpd('{{post.date}}');
            </script>
          </small>
        </li>
      </a>
      {% endunless %}
      {% endfor %}
    </ul>
    {% endif %}
    {% endfor %}
  </div>
</div>